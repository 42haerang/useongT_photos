<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>감성 앨범 · 8 Photos</title>
  <style>
    :root{
      --bg:#0f0f10;
      --card:#17181a;
      --ink:#e9ecef;
      --muted:#a0a4ab;
      --line:#26282c;
      --accent:#e8d4b0;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Arial,Helvetica,sans-serif}

    /* 배경 두 장 */
    .bgwrap{position:fixed;inset:0;z-index:-1;}
    .bgwrap .bg{position:absolute;inset:0;background-position:center;background-size:cover;
      opacity:0;transition:opacity 1.2s ease;filter:brightness(.9) contrast(1.03) saturate(1.02);}
    .bgwrap .bg.show{opacity:.9}

    header{position:sticky;top:0;backdrop-filter:saturate(1.2) blur(6px);
      background:linear-gradient(180deg,rgba(15,15,16,.9),rgba(15,15,16,.6) 70%,rgba(15,15,16,0));
      padding:18px 16px 10px;border-bottom:1px solid var(--line);z-index:10}
    header h1{margin:0;font-size:20px;letter-spacing:.4px}
    header p{margin:6px 0 0;color:var(--muted);font-size:12.5px}

    .album{display:grid;gap:14px;padding:14px}
    .card{background:var(--card);border:1px solid var(--line);
      border-radius:18px;overflow:hidden;box-shadow:0 6px 16px rgba(0,0,0,.25)}

    /* 프레임 + 기울임 */
    .polaroid{padding:12px 12px 16px;background:#111214cc;border-radius:16px;
      border:1px solid var(--line);box-shadow:0 10px 26px rgba(0,0,0,.35);}
    .polaroid__inner{background:#0b0c0e;border-radius:12px;overflow:hidden;
      border:1px solid #2a2c31;transform:rotate(var(--rot,0deg));
      transform-origin:center;transition:transform .25s ease,box-shadow .25s ease;
      box-shadow:0 5px 14px rgba(0,0,0,.3);}
    .polaroid__inner:hover{box-shadow:0 12px 24px rgba(0,0,0,.5);}
    .polaroid__inner img{width:100%;height:100%;display:block;object-fit:cover;aspect-ratio:4/5;}
    .cap{padding:12px 14px 14px}
    .cap h3{margin:0 0 4px;font-size:15px}
    .cap p{margin:0;color:var(--muted);font-size:12.5px}

    /* 전체화면 뷰어 */
    .viewer{position:fixed;inset:0;background:rgba(8,8,10,.96);display:none;
      align-items:center;justify-content:center;z-index:50}
    .viewer.open{display:flex}
    .viewer__imgwrap{position:relative;width:100vw;height:100vh;overflow:hidden;touch-action:none}
    .viewer__img{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
      max-width:100vw;max-height:100vh;object-fit:contain;transition:transform .25s ease}
    .viewer__top,.viewer__bot{position:absolute;left:0;right:0;padding:10px 12px;
      display:flex;align-items:center;justify-content:space-between;pointer-events:none}
    .viewer__top{top:0;background:linear-gradient(180deg,rgba(0,0,0,.45),transparent)}
    .viewer__bot{bottom:0;background:linear-gradient(0deg,rgba(0,0,0,.45),transparent)}
    .chip{pointer-events:auto;border:1px solid var(--line);background:rgba(32,33,36,.7);
      color:var(--ink);padding:8px 11px;border-radius:999px;font-size:12.5px;
      display:inline-flex;gap:8px;align-items:center}
    .index{pointer-events:auto;margin-left:auto}
    .navZone{position:absolute;top:0;bottom:0;width:32%;}
    .navPrev{left:0}
    .navNext{right:0}
    .swiping .viewer__img{transition:none}
    body.lock{overflow:hidden;touch-action:none}
    @media(min-width:640px){.album{grid-template-columns:1fr 1fr}}
  </style>
</head>
<body>
  <!-- 배경 2장 -->
  <div class="bgwrap" aria-hidden="true">
    <div class="bg" id="bg1"></div>
    <div class="bg" id="bg2"></div>
  </div>

  <header>
    <h1>감성 앨범</h1>
    <p>가볍게 스크롤하고, 탭하면 꽉 채워 보기 · 좌우 스와이프로 넘기기</p>
  </header>

  <main class="album" id="album"></main>

  <section class="viewer" id="viewer" aria-hidden="true">
    <div class="viewer__imgwrap" id="imgWrap">
      <img id="big" class="viewer__img" alt="큰 이미지" />
      <div class="viewer__top">
        <button class="chip" id="closeBtn" aria-label="닫기">닫기</button>
        <span class="chip index" id="counter">1 / 8</span>
      </div>
      <div class="viewer__bot">
        <span class="chip" id="caption">캡션</span>
        <span class="chip" id="hint">좌우 스와이프 · 더블탭 확대</span>
      </div>
      <div class="navZone navPrev" id="zonePrev"></div>
      <div class="navZone navNext" id="zoneNext"></div>
    </div>
  </section>

  <script>
    const images = [
      {src:'01.jpg',title:'장면 1',text:'햇살이 머무른 오후의 골목'},
      {src:'02.jpg',title:'장면 2',text:'바람이 지나가 남긴 파문'},
      {src:'03.jpg',title:'장면 3',text:'창가에 내려앉은 고요'},
      {src:'04.jpg',title:'장면 4',text:'멀리 번진 불빛의 숨결'},
      {src:'05.jpg',title:'장면 5',text:'비에 젖은 도로의 노래'},
      {src:'06.jpg',title:'장면 6',text:'한 발 늦은 저녁 인사'},
      {src:'07.jpg',title:'장면 7',text:'천천히 흐르는 장면들'},
      {src:'08.jpg',title:'장면 8',text:'끝나지 않는 여운'}
    ];
    const backgrounds=['bg1.jpg','bg2.jpg'];

    // 배경 전환
    const bg1=document.getElementById('bg1');
    const bg2=document.getElementById('bg2');
    let bgIndex=0,bgShowing=0;
    const applyBg=()=>{
      const nextSrc=backgrounds[bgIndex%backgrounds.length];
      if(bgShowing===0){bg2.style.backgroundImage=`url(${nextSrc})`;bg2.classList.add('show');bg1.classList.remove('show');bgShowing=1;}
      else{bg1.style.backgroundImage=`url(${nextSrc})`;bg1.classList.add('show');bg2.classList.remove('show');bgShowing=0;}
      bgIndex++;
    };
    bg1.style.backgroundImage=`url(${backgrounds[0]||''})`;
    bg1.classList.add('show');
    setInterval(()=>{if(backgrounds.length>1)applyBg();},10000);

    // 카드 리스트
    const album=document.getElementById('album');
    const randTilt=()=>{const ang=30+Math.random()*15;const sign=Math.random()<.5?-1:1;return +(ang*sign).toFixed(1);}
    album.innerHTML=images.map((it,idx)=>{
      const rot=randTilt();
      return `
      <article class="card" data-idx="${idx}">
        <div class="polaroid">
          <div class="polaroid__inner" style="--rot:${rot}deg">
            <a class="thumb" href="#" aria-label="${it.title} 크게 보기">
              <img loading="lazy" decoding="async" src="${it.src}" alt="${it.title}">
            </a>
          </div>
        </div>
        <div class="cap"><h3>${it.title}</h3><p>${it.text}</p></div>
      </article>`;
    }).join('');

    // 뷰어
    const viewer=document.getElementById('viewer');
    const big=document.getElementById('big');
    const counter=document.getElementById('counter');
    const caption=document.getElementById('caption');
    const closeBtn=document.getElementById('closeBtn');
    const zonePrev=document.getElementById('zonePrev');
    const zoneNext=document.getElementById('zoneNext');
    const imgWrap=document.getElementById('imgWrap');

    let current=0,isOpen=false,scale=1;

    const openViewer=(idx)=>{
      current=idx;updateBig();
      viewer.classList.add('open');viewer.setAttribute('aria-hidden','false');
      document.body.classList.add('lock');isOpen=true;preloadAround();
    };
    const closeViewer=()=>{
      viewer.classList.remove('open');viewer.setAttribute('aria-hidden','true');
      document.body.classList.remove('lock');isOpen=false;scale=1;applyScale();
    };
    const updateBig=()=>{
      const item=images[current];
      big.src=item.src;big.alt=item.title;
      counter.textContent=`${current+1} / ${images.length}`;
      caption.textContent=item.text||'';
    };
    const go=(dir)=>{
      current=(current+dir+images.length)%images.length;
      scale=1;applyScale();updateBig();preloadAround();
    };
    const preload=(src)=>{const i=new Image();i.src=src;};
    const preloadAround=()=>{
      const p=(current-1+images.length)%images.length;
      const n=(current+1)%images.length;
      preload(images[p].src);preload(images[n].src);
    };

    album.addEventListener('click',(e)=>{
      const card=e.target.closest('.card');
      if(!card)return;
      e.preventDefault();
      openViewer(+card.dataset.idx);
    });
    closeBtn.addEventListener('click',closeViewer);
    zonePrev.addEventListener('click',()=>go(-1));
    zoneNext.addEventListener('click',()=>go(1));

    let startX=0,lastX=0,swiping=false;
    imgWrap.addEventListener('touchstart',(e)=>{
      if(e.touches.length>1)return;
      startX=lastX=e.touches[0].clientX;
      viewer.classList.add('swiping');swiping=true;
    },{passive:true});
    imgWrap.addEventListener('touchmove',(e)=>{
      if(!swiping||e.touches.length>1)return;
      const x=e.touches[0].clientX,dx=x-startX;
      lastX=x;big.style.transform=`translate(calc(-50% + ${dx}px), -50%) scale(${scale})`;
    },{passive:true});
    imgWrap.addEventListener('touchend',()=>{
      if(!swiping)return;
      const dx=lastX-startX;viewer.classList.remove('swiping');
      big.style.transform=`translate(-50%,-50%) scale(${scale})`;swiping=false;
      if(Math.abs(dx)>60)go(dx<0?1:-1);
    });

    let lastTap=0;
    imgWrap.addEventListener('touchend',(e)=>{
      const now=Date.now();
      if(now-lastTap<280){scale=(scale===1)?2.1:1;applyScale();}
      lastTap=now;
    });
    const applyScale=()=>{big.style.transform=`translate(-50%,-50%) scale(${scale})`;};
    window.addEventListener('keydown',(e)=>{
      if(!isOpen)return;
      if(e.key==='Escape')closeViewer();
      if(e.key==='ArrowRight')go(1);
      if(e.key==='ArrowLeft')go(-1);
    });
  </script>
</body>
</html>
